<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holding the Line: A Playbook for ESG Leadership | Prof. Ioannis Ioannou</title>
    <meta name="description" content="An interactive self-assessment for sustainability leaders navigating ESG backlash. Rate your organisation across 20 dimensions, reflect on strategic questions, and generate a private diagnostic. By Prof. Ioannis Ioannou, London Business School.">
    <meta name="author" content="Professor Ioannis Ioannou">
    <meta name="keywords" content="ESG playbook, sustainability leadership, ESG backlash, corporate responsibility assessment, sustainability strategy, Ioannis Ioannou, London Business School, ESG self-assessment, hostile terrain, aligned capitalism">
    <link rel="canonical" href="https://www.ioannou.us/playbook.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.ioannou.us/playbook.html">
    <meta property="og:title" content="Holding the Line: A Playbook for ESG Leadership in Hostile Terrain">
    <meta property="og:description" content="An interactive self-assessment for sustainability leaders navigating ESG backlash. Rate your organisation across 20 dimensions and generate a private diagnostic.">
    <meta property="og:image" content="https://www.ioannou.us/images/hero-portrait.jpg">
    <meta property="og:site_name" content="Prof. Ioannis Ioannou">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.ioannou.us/playbook.html">
    <meta name="twitter:title" content="Holding the Line: A Playbook for ESG Leadership in Hostile Terrain">
    <meta name="twitter:description" content="An interactive self-assessment for sustainability leaders navigating ESG backlash. Rate your organisation across 20 dimensions and generate a private diagnostic.">
    <meta name="twitter:image" content="https://www.ioannou.us/images/hero-portrait.jpg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Holding the Line: A Playbook for ESG Leadership in Hostile Terrain",
        "description": "An interactive self-assessment for sustainability leaders navigating ESG backlash. Rate your organisation across 20 dimensions, reflect on strategic questions, and generate a private diagnostic.",
        "url": "https://www.ioannou.us/playbook.html",
        "author": {
            "@type": "Person",
            "name": "Ioannis Ioannou",
            "honorificPrefix": "Prof.",
            "jobTitle": "Associate Professor of Strategy and Entrepreneurship",
            "worksFor": {
                "@type": "Organization",
                "name": "London Business School",
                "url": "https://www.london.edu"
            }
        },
        "isPartOf": {
            "@type": "WebSite",
            "name": "Prof. Ioannis Ioannou",
            "url": "https://www.ioannou.us"
        },
        "keywords": ["ESG", "sustainability leadership", "corporate responsibility", "ESG backlash", "self-assessment", "aligned capitalism"]
    }
    </script>
    <style>
        /* ── Design Tokens (matching site) ── */
        :root {
            --color-primary: #1a365d;
            --color-secondary: #2c5282;
            --color-accent: #c53030;
            --color-accent-hover: #9b2c2c;
            --color-text: #1a202c;
            --color-text-light: #4a5568;
            --color-text-muted: #718096;
            --color-bg: #ffffff;
            --color-bg-subtle: #f7fafc;
            --color-bg-warm: #fffaf5;
            --color-bg-dark: #1a202c;
            --color-border: #e2e8f0;
            --color-border-dark: #cbd5e0;
            --font-display: 'Cormorant Garamond', Georgia, serif;
            --font-body: 'Source Sans 3', -apple-system, BlinkMacSystemFont, sans-serif;
            --text-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
            --text-sm: clamp(0.875rem, 0.8rem + 0.35vw, 1rem);
            --text-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
            --text-lg: clamp(1.125rem, 1rem + 0.6vw, 1.25rem);
            --text-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
            --text-2xl: clamp(1.5rem, 1.25rem + 1.25vw, 2rem);
            --text-3xl: clamp(1.875rem, 1.5rem + 1.875vw, 2.5rem);
            --text-4xl: clamp(2.25rem, 1.75rem + 2.5vw, 3.5rem);
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --space-3xl: 4rem;
            --space-4xl: 6rem;
            --container-max: 1280px;
            --container-narrow: 900px;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            --transition-fast: 150ms ease;
            --transition-base: 250ms ease;
            --transition-slow: 400ms ease;
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }

        /* ── Reset & Base ── */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
        body {
            font-family: var(--font-body);
            font-size: var(--text-base);
            font-weight: 400;
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
        }
        a { color: var(--color-secondary); text-decoration: none; }
        a:hover { color: var(--color-primary); }
        h1, h2, h3, h4 { font-family: var(--font-display); font-weight: 500; line-height: 1.2; color: var(--color-text); }

        /* ── Layout ── */
        .container { max-width: var(--container-max); margin: 0 auto; padding: 0 var(--space-xl); }
        .container-narrow { max-width: var(--container-narrow); margin: 0 auto; padding: 0 var(--space-xl); }

        /* ── Header (matching site) ── */
        .site-header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--color-border);
        }
        .main-nav { display: flex; align-items: center; justify-content: space-between; height: 72px; }
        .nav-logo { font-family: var(--font-display); font-size: var(--text-xl); font-weight: 600; color: var(--color-primary); text-decoration: none; }
        .nav-links { display: flex; gap: var(--space-xl); list-style: none; }
        .nav-links a { font-size: var(--text-sm); font-weight: 500; color: var(--color-text-light); text-decoration: none; transition: color var(--transition-fast); }
        .nav-links a:hover { color: var(--color-primary); }
        .nav-back { font-size: var(--text-sm); font-weight: 500; color: var(--color-text-light); text-decoration: none; }
        .nav-back:hover { color: var(--color-primary); }

        /* ── Hero ── */
        .playbook-hero {
            padding: calc(72px + var(--space-4xl)) 0 var(--space-3xl);
            background: var(--color-bg-dark);
            color: white;
        }
        .playbook-hero h1 {
            font-size: var(--text-4xl);
            color: white;
            margin-bottom: var(--space-md);
        }
        .playbook-hero .subtitle {
            font-size: var(--text-xl);
            color: rgba(255,255,255,0.7);
            font-weight: 300;
            margin-bottom: var(--space-lg);
        }
        .hero-actions { display: flex; gap: var(--space-md); flex-wrap: wrap; }
        .btn-pdf {
            display: inline-flex; align-items: center; gap: var(--space-sm);
            padding: var(--space-sm) var(--space-lg);
            font-family: var(--font-body); font-size: var(--text-sm); font-weight: 600;
            text-transform: uppercase; letter-spacing: 0.05em;
            border-radius: var(--radius-sm);
            transition: all var(--transition-base);
            cursor: pointer; text-decoration: none;
            background: transparent; color: rgba(255,255,255,0.8); border: 1px solid rgba(255,255,255,0.3);
        }
        .btn-pdf:hover { color: white; border-color: rgba(255,255,255,0.6); background: rgba(255,255,255,0.08); }
        .btn-pdf svg { width: 16px; height: 16px; }

        /* ── Progress Bar ── */
        .progress-bar-container {
            position: sticky; top: 72px; z-index: 500;
            background: var(--color-bg); border-bottom: 1px solid var(--color-border);
            padding: var(--space-md) 0 var(--space-2xl);
        }
        .progress-sections {
            display: flex; gap: var(--space-xs); align-items: center;
        }
        .progress-step {
            flex: 1; height: 4px; background: var(--color-border); border-radius: 2px;
            transition: background var(--transition-base); cursor: pointer; position: relative;
        }
        .progress-step.active { background: var(--color-secondary); }
        .progress-step.completed { background: var(--color-accent); }
        .progress-label {
            position: absolute; top: 12px; left: 0;
            font-family: var(--font-body); font-size: var(--text-xs); font-weight: 500;
            color: var(--color-text-muted); white-space: nowrap; display: none;
        }
        .progress-step.active .progress-label { color: var(--color-secondary); font-weight: 600; }
        .progress-step.completed .progress-label { color: var(--color-accent); }
        @media (min-width: 768px) {
            .progress-label { display: block; }
        }

        /* ── Section Base ── */
        .playbook-section {
            padding: var(--space-4xl) 0;
            border-bottom: 1px solid var(--color-border);
        }
        .playbook-section:last-of-type { border-bottom: none; }
        .section-number {
            font-size: var(--text-xs); font-weight: 600; text-transform: uppercase;
            letter-spacing: 0.15em; color: var(--color-accent); margin-bottom: var(--space-lg);
            display: inline-block;
        }
        .playbook-section > .container-narrow > h2 {
            font-size: var(--text-3xl); color: var(--color-primary); margin-bottom: var(--space-2xl);
        }

        /* ── Intro Section ── */
        .intro-text { color: var(--color-text-light); font-size: var(--text-lg); line-height: 1.8; }
        .intro-text p { margin-bottom: var(--space-lg); }

        /* ── Cards (Do / Don't) ── */
        .cards-grid { display: flex; flex-direction: column; gap: var(--space-md); }
        .playbook-card {
            border: 1px solid var(--color-border); border-radius: var(--radius-md);
            overflow: hidden; transition: all var(--transition-base);
            background: var(--color-bg);
        }
        .playbook-card:hover { border-color: var(--color-border-dark); box-shadow: var(--shadow-sm); }
        .card-header {
            display: flex; align-items: center; justify-content: space-between; gap: var(--space-md);
            padding: var(--space-lg) var(--space-xl);
            cursor: pointer; user-select: none;
        }
        .card-header-left { display: flex; align-items: center; gap: var(--space-md); flex: 1; }
        .card-number {
            font-family: var(--font-display); font-size: var(--text-lg); font-weight: 700;
            color: var(--color-accent); min-width: 2rem;
        }
        .card-title {
            font-family: var(--font-body); font-size: var(--text-base); font-weight: 600;
            color: var(--color-primary); line-height: 1.4;
        }
        .card-chevron {
            width: 20px; height: 20px; color: var(--color-text-muted);
            transition: transform var(--transition-base); flex-shrink: 0;
        }
        .playbook-card.open .card-chevron { transform: rotate(180deg); }
        .card-body {
            max-height: 0; overflow: hidden; transition: max-height 0.4s ease, padding 0.3s ease;
        }
        .playbook-card.open .card-body { max-height: 600px; }
        .card-body-inner {
            padding: 0 var(--space-xl) var(--space-xl);
            padding-left: calc(var(--space-xl) + 2rem + var(--space-md));
        }
        .card-body-inner p {
            color: var(--color-text-light); font-size: var(--text-sm); line-height: 1.7;
            margin-bottom: var(--space-lg);
        }

        /* ── Self-Assessment 1-7 Scale ── */
        .scale-row { display: flex; flex-direction: column; gap: var(--space-xs); }
        .scale-label-row {
            display: flex; justify-content: space-between;
            font-size: var(--text-xs); color: var(--color-text-muted);
        }
        .scale-buttons { display: flex; gap: var(--space-sm); }
        .scale-btn {
            flex: 1; height: 44px;
            display: flex; align-items: center; justify-content: center;
            font-family: var(--font-body); font-size: var(--text-sm); font-weight: 600;
            border: 1px solid var(--color-border); border-radius: var(--radius-sm);
            background: var(--color-bg); color: var(--color-text-light);
            cursor: pointer; transition: all var(--transition-fast);
        }
        .scale-btn:hover { border-color: var(--color-secondary); color: var(--color-secondary); background: var(--color-bg-subtle); }
        .scale-btn.selected {
            background: var(--color-primary); border-color: var(--color-primary);
            color: white;
        }

        /* ── Reflection Questions ── */
        .question-card {
            background: var(--color-bg-warm); border-radius: var(--radius-md);
            padding: var(--space-2xl); margin-bottom: var(--space-xl);
            border-left: 3px solid var(--color-accent);
        }
        .question-card h3 {
            font-size: var(--text-xl); color: var(--color-primary); margin-bottom: var(--space-lg);
        }
        .question-card > p {
            color: var(--color-text-light); font-size: var(--text-sm); line-height: 1.7;
            margin-bottom: var(--space-lg);
        }
        .reflection-textarea {
            width: 100%; min-height: 100px; padding: var(--space-md);
            font-family: var(--font-body); font-size: var(--text-sm);
            border: 1px solid var(--color-border); border-radius: var(--radius-sm);
            background: white; color: var(--color-text);
            resize: vertical; transition: border-color var(--transition-fast);
            line-height: 1.6;
        }
        .reflection-textarea:focus { outline: none; border-color: var(--color-secondary); }
        .reflection-textarea::placeholder { color: var(--color-text-muted); }

        /* ── Personal Questions (different feel) ── */
        .personal-section { background: var(--color-bg-subtle); }
        .personal-card {
            background: white; border-radius: var(--radius-md);
            padding: var(--space-2xl); margin-bottom: var(--space-xl);
            border-left: 3px solid var(--color-secondary);
        }
        .personal-card h3 { font-size: var(--text-xl); color: var(--color-primary); margin-bottom: var(--space-lg); }
        .personal-card > p { color: var(--color-text-light); font-size: var(--text-sm); line-height: 1.7; margin-bottom: var(--space-lg); }

        /* ── Closing ── */
        .closing-section { background: var(--color-bg-warm); }
        .closing-section h3 {
            font-size: var(--text-2xl); color: var(--color-primary); margin-bottom: var(--space-lg);
        }
        .closing-section p {
            color: var(--color-text-light); font-size: var(--text-base); line-height: 1.8;
            margin-bottom: var(--space-lg);
        }

        /* ── Summary Dashboard ── */
        .summary-section { background: var(--color-bg-dark); color: white; }
        .summary-section h2 { color: #ffffff; }
        .summary-section.playbook-section > .container-narrow > h2 { color: #ffffff; }
        .summary-grid {
            display: grid; grid-template-columns: repeat(2, 1fr);
            gap: var(--space-xl); margin-bottom: var(--space-2xl); text-align: center;
        }
        @media (max-width: 640px) { .summary-grid { grid-template-columns: 1fr; } }
        .summary-stat-number {
            font-family: var(--font-display); font-size: var(--text-4xl);
            font-weight: 700; margin-bottom: var(--space-xs); color: white;
        }
        .summary-stat-label { font-size: var(--text-sm); color: rgba(255,255,255,0.6); }
        .summary-bar-container {
            max-width: 500px; margin: 0 auto var(--space-xl);
        }
        .summary-bar-bg {
            width: 100%; height: 12px; background: rgba(255,255,255,0.15);
            border-radius: 6px; overflow: hidden;
        }
        .summary-bar-fill {
            height: 100%; background: var(--color-accent); border-radius: 6px;
            transition: width 0.6s ease;
        }
        .summary-bar-labels {
            display: flex; justify-content: space-between;
            font-size: var(--text-xs); color: rgba(255,255,255,0.4); margin-top: var(--space-xs);
        }
        .summary-stat-label { font-size: var(--text-sm); color: rgba(255,255,255,0.6); }
        .summary-note {
            font-size: var(--text-sm); color: rgba(255,255,255,0.5);
            text-align: center; margin-bottom: var(--space-2xl);
        }
        /* ── Heatmap ── */
        .heatmap-panel {
            margin-bottom: var(--space-2xl); display: none;
        }
        .heatmap-panel.visible { display: block; }
        .heatmap-panel h3 {
            font-size: var(--text-xl); color: #ffffff; margin-bottom: var(--space-lg);
            text-align: center;
        }
        .heatmap-group-label {
            font-size: var(--text-xs); font-weight: 600; text-transform: uppercase;
            letter-spacing: 0.12em; color: rgba(255,255,255,0.45);
            margin-bottom: var(--space-sm); margin-top: var(--space-lg);
        }
        .heatmap-group-label:first-of-type { margin-top: 0; }
        .heatmap-row {
            display: grid; grid-template-columns: repeat(10, 1fr);
            gap: 6px;
        }
        @media (max-width: 640px) { .heatmap-row { grid-template-columns: repeat(5, 1fr); } }
        .heatmap-cell {
            aspect-ratio: 1; border-radius: var(--radius-sm);
            display: flex; align-items: center; justify-content: center;
            font-family: var(--font-body); font-size: var(--text-sm); font-weight: 700;
            color: white; position: relative; cursor: default;
            transition: transform var(--transition-fast), box-shadow var(--transition-fast);
            border: 1px solid rgba(255,255,255,0.08);
        }
        .heatmap-cell:hover { transform: scale(1.12); box-shadow: 0 4px 16px rgba(0,0,0,0.3); z-index: 2; }
        .heatmap-cell .cell-number {
            font-size: var(--text-xs); font-weight: 600;
        }
        .heatmap-cell .cell-tooltip {
            display: none; position: absolute; bottom: calc(100% + 8px); left: 50%;
            transform: translateX(-50%); background: white; color: var(--color-text);
            font-size: 0.72rem; font-weight: 400; line-height: 1.4;
            padding: 8px 12px; border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg); white-space: nowrap; max-width: 260px;
            white-space: normal; z-index: 10; pointer-events: none;
        }
        .heatmap-cell .cell-tooltip::after {
            content: ''; position: absolute; top: 100%; left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent; border-top-color: white;
        }
        .heatmap-cell:hover .cell-tooltip { display: block; }
        .heatmap-unrated { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.25); }
        .heatmap-legend {
            display: flex; align-items: center; justify-content: center;
            gap: var(--space-sm); margin-top: var(--space-lg);
            font-size: var(--text-xs); color: rgba(255,255,255,0.45);
        }
        .legend-swatch {
            width: 16px; height: 16px; border-radius: 3px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        /* ── Insights (top / bottom) ── */
        .insights-panel {
            display: none; margin-bottom: var(--space-2xl);
        }
        .insights-panel.visible { display: block; }
        .insights-columns {
            display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-xl);
        }
        @media (max-width: 640px) { .insights-columns { grid-template-columns: 1fr; } }
        .insights-col h4 {
            font-family: var(--font-body); font-size: var(--text-xs); font-weight: 600;
            text-transform: uppercase; letter-spacing: 0.1em;
            margin-bottom: var(--space-md); padding-bottom: var(--space-sm);
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }
        .insights-col.strengths h4 { color: #4ade80; }
        .insights-col.priorities h4 { color: #fbbf24; }
        .insight-item {
            display: flex; align-items: baseline; gap: var(--space-sm);
            margin-bottom: var(--space-sm); font-size: var(--text-sm);
            color: rgba(255,255,255,0.8); line-height: 1.4;
        }
        .insight-score {
            font-family: var(--font-display); font-weight: 700;
            min-width: 1.8rem; text-align: right;
        }
        .insight-item.strength .insight-score { color: #4ade80; }
        .insight-item.priority .insight-score { color: #fbbf24; }
        .export-actions {
            display: flex; gap: var(--space-md); justify-content: center; flex-wrap: wrap;
        }
        .btn-export {
            display: inline-flex; align-items: center; gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            font-family: var(--font-body); font-size: var(--text-sm); font-weight: 600;
            text-transform: uppercase; letter-spacing: 0.05em;
            border-radius: var(--radius-sm); cursor: pointer;
            transition: all var(--transition-base); text-decoration: none; border: none;
        }
        .btn-export-primary { background: var(--color-accent); color: white; }
        .btn-export-primary:hover { background: var(--color-accent-hover); transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .btn-export-secondary { background: transparent; color: rgba(255,255,255,0.8); border: 1px solid rgba(255,255,255,0.3); }
        .btn-export-secondary:hover { color: white; border-color: rgba(255,255,255,0.6); background: rgba(255,255,255,0.08); }

        /* ── Footer ── */
        .playbook-footer {
            padding: var(--space-2xl) 0;
            background: var(--color-bg-dark); border-top: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }
        .playbook-footer p { font-size: var(--text-sm); color: rgba(255,255,255,0.4); }
        .playbook-footer a { color: rgba(255,255,255,0.6); }
        .playbook-footer a:hover { color: white; }

        /* ── Utility ── */
        .visually-hidden { position: absolute; width: 1px; height: 1px; overflow: hidden; clip: rect(0,0,0,0); }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <nav class="main-nav">
                <a href="index.html" class="nav-logo">Prof. Ioannis Ioannou</a>
                <a href="thought-leadership.html" class="nav-back">← Back to Thought Leadership</a>
            </nav>
        </div>
    </header>

    <!-- Hero -->
    <section class="playbook-hero">
        <div class="container-narrow">
            <h1>Holding the Line</h1>
            <p class="subtitle">A Playbook for ESG Leadership in Hostile Terrain</p>
            <div class="hero-actions">
                <a href="docs/holding-the-line-playbook.pdf" download class="btn-pdf">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Download full playbook (PDF)
                </a>
            </div>
        </div>
    </section>

    <!-- Progress Bar -->
    <div class="progress-bar-container">
        <div class="container-narrow">
            <div class="progress-sections">
                <div class="progress-step active" data-section="0"><span class="progress-label">Introduction</span></div>
                <div class="progress-step" data-section="1"><span class="progress-label">10 To Do</span></div>
                <div class="progress-step" data-section="2"><span class="progress-label">10 To Avoid</span></div>
                <div class="progress-step" data-section="3"><span class="progress-label">7 Questions</span></div>
                <div class="progress-step" data-section="4"><span class="progress-label">7 Reflections</span></div>
                <div class="progress-step" data-section="5"><span class="progress-label">Closing</span></div>
            </div>
        </div>
    </div>

    <!-- Section 1: The Terrain Has Shifted -->
    <section class="playbook-section" id="section-0">
        <div class="container-narrow">
            <span class="section-number">Introduction</span>
            <h2>The terrain has shifted</h2>
            <div class="intro-text">
                <p>Not long ago, ESG was ascendant. It had momentum, institutional alignment, and a growing public presence. Capital flowed, teams expanded, disclosure frameworks multiplied. For a time, it seemed that sustainability had crossed a threshold — from marginal to mainstream, from optional to strategic.</p>
                <p>But the ground has shifted. ESG is now a target: politicised, polarised, and, in many cases, strategically downplayed. Companies are relabelling or retreating. Regulatory efforts are being contested or diluted. And within firms, the leaders once tasked with driving sustainability are encountering growing doubt and hesitation — from boards, from peers, and even from themselves.</p>
                <p>This playbook is for them. For the ESG professionals, sustainability strategists, and corporate leaders trying to do the work in an increasingly hostile climate. It is a tool for navigating this moment with long-term strategic clarity and personal integrity. A way to reflect, recalibrate, and hold the line — not ideologically, but structurally. Not defensively, but deliberately.</p>
                <p>The terrain has shifted. The question is no longer how loud we speak — but whether we are still standing when the noise subsides.</p>
                <p style="color: var(--color-accent); margin-top: var(--space-xl);">Note: This is a private self-assessment. Your responses stay in your browser and are not collected, stored, or shared with anyone. Rate honestly — the value is in the reflection, not the score.</p>
            </div>
        </div>
    </section>

    <!-- Section 2: 10 Things To Do Now -->
    <section class="playbook-section" id="section-1">
        <div class="container-narrow">
            <span class="section-number">Strategic Actions</span>
            <h2>10 things to do now</h2>
            <div class="cards-grid" id="do-cards"></div>
        </div>
    </section>

    <!-- Section 3: 10 Things Not To Do -->
    <section class="playbook-section" id="section-2">
        <div class="container-narrow">
            <span class="section-number">Strategic Pitfalls</span>
            <h2>10 things not to do</h2>
            <div class="cards-grid" id="dont-cards"></div>
        </div>
    </section>

    <!-- Section 4: 7 Questions To Ask -->
    <section class="playbook-section" id="section-3">
        <div class="container-narrow">
            <span class="section-number">Organisational Inquiry</span>
            <h2>7 questions to ask</h2>
            <div id="questions-container"></div>
        </div>
    </section>

    <!-- Section 5: 7 Things Only You Can Answer -->
    <section class="playbook-section personal-section" id="section-4">
        <div class="container-narrow">
            <span class="section-number">Personal Reflection</span>
            <h2>7 things only you can answer</h2>
            <div id="personal-container"></div>
        </div>
    </section>

    <!-- Section 6: Closing -->
    <section class="playbook-section closing-section" id="section-5">
        <div class="container-narrow">
            <span class="section-number">Looking Forward</span>
            <h2>When the noise fades, what will remain?</h2>
            <div class="closing-text">
                <h3>Sustaining Courage Without Illusion</h3>
                <p>The ESG backlash has made one thing clear: this was never going to be easy. The noise may have changed, but the underlying risks have not. Climate volatility, social fragmentation, political disruption — these remain as real and immediate as ever. What has changed is our willingness to talk about them.</p>
                <p>And yet, for those doing the work from within, this moment can also be clarifying. It separates symbolism from substance. It reveals which commitments were built for momentum — and which were built for resistance.</p>

                <h3>Reframing ESG as Strategic Leadership</h3>
                <p>Sustainability is not a side agenda. It is a lens through which to understand operational fragility, systemic risk, and long-term value creation. ESG professionals are not support staff. They are architects of institutional resilience — integrating environmental reality, social legitimacy, and governance capacity into the strategic core of the business.</p>

                <h3>What Will You Be Able to Say?</h3>
                <p>Picture yourself five or ten years from now. The political noise will have faded or turned into something else. The science will be harder to contest. The consequences — social, environmental, economic — will be more visible, more personal, and more widely felt.</p>
                <p>In that moment, what will you be able to say? What decisions will you have made that aged well? What evidence will you leave — not in language, but in structure, in priorities, in choices made when no one was clapping?</p>
                <p>That's the horizon to lead from. Not today's turbulence, but tomorrow's account. Because when the noise fades, what will remain is what you chose to build when it was hardest to try.</p>
            </div>
        </div>
    </section>

    <!-- Summary & Export -->
    <section class="playbook-section summary-section" id="section-summary">
        <div class="container-narrow">
            <span class="section-number" style="color: rgba(255,255,255,0.5);">Your Results</span>
            <h2>Your Playbook Summary</h2>
            <div class="summary-grid">
                <div>
                    <div class="summary-stat-number" id="avg-score">—</div>
                    <div class="summary-stat-label">Average score (out of 7)</div>
                </div>
                <div>
                    <div class="summary-stat-number" id="count-rated">0</div>
                    <div class="summary-stat-label">Items rated (out of 20)</div>
                </div>
            </div>
            <div class="summary-bar-container">
                <div class="summary-bar-bg">
                    <div class="summary-bar-fill" id="summary-bar" style="width: 0%"></div>
                </div>
                <div class="summary-bar-labels">
                    <span>1 — We don't do this</span>
                    <span>7 — We do this well</span>
                </div>
            </div>
            <!-- Heatmap -->
            <div class="heatmap-panel" id="heatmap-panel">
                <h3>Your Assessment at a Glance</h3>
                <div class="heatmap-group-label">10 Things to Do</div>
                <div class="heatmap-row" id="heatmap-do"></div>
                <div class="heatmap-group-label">10 Things to Avoid</div>
                <div class="heatmap-row" id="heatmap-dont"></div>
                <div class="heatmap-legend">
                    <span>Low</span>
                    <div class="legend-swatch" style="background:#c53030;"></div>
                    <div class="legend-swatch" style="background:#d97706;"></div>
                    <div class="legend-swatch" style="background:#ca8a04;"></div>
                    <div class="legend-swatch" style="background:#65a30d;"></div>
                    <div class="legend-swatch" style="background:#16a34a;"></div>
                    <div class="legend-swatch" style="background:#059669;"></div>
                    <div class="legend-swatch" style="background:#0d9488;"></div>
                    <span>High</span>
                </div>
            </div>
            <!-- Insights -->
            <div class="insights-panel" id="insights-panel">
                <div class="insights-columns">
                    <div class="insights-col strengths">
                        <h4>Strongest areas</h4>
                        <div id="insights-strengths"></div>
                    </div>
                    <div class="insights-col priorities">
                        <h4>Priority areas</h4>
                        <div id="insights-priorities"></div>
                    </div>
                </div>
            </div>
            <p class="summary-note">Based on your self-assessment across all rated items.</p>
            <div class="export-actions">
                <button class="btn-export btn-export-primary" aria-label="Download your reflections as a PDF" onclick="exportReflections()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Download My Reflections (PDF)
                </button>
                <a href="docs/holding-the-line-playbook.pdf" download class="btn-export btn-export-secondary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                    Download Full Playbook (PDF)
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="playbook-footer">
        <div class="container-narrow">
            <p>Holding the Line: A Playbook for ESG Leadership in Hostile Terrain</p>
            <p style="margin-top: var(--space-sm);">&copy; 2026 Professor Ioannis Ioannou. All rights reserved.</p>
        </div>
    </footer>

<script>
// ── Data ──
const doItems = [
    { title: "Use ESG as a lens for strategic foresight — not as a reputational cover.", body: "Sustainability should help you anticipate systemic disruption — not obscure it with language. Reframing ESG as 'resilience' or 'purpose' only matters if the underlying commitments deepen. This is not about what you call it — it's about what it prepares you for." },
    { title: "Keep a long memory.", body: "The backlash is loud, but it's not permanent. Climate change, inequality, regulatory volatility — these aren't trends, they're constraints. ESG is about staying relevant over decades, not quarters." },
    { title: "Build governance literacy at the top.", body: "If your board doesn't understand sustainability as a strategic concern, you have a structural vulnerability. Move beyond slide decks — equip directors to ask better questions, interpret non-financial signals, and engage with trade-offs." },
    { title: "Strengthen your internal alliances.", body: "Sustainability cannot succeed when it operates as a silo. It needs legal to own compliance risk, finance to own capital reallocation, operations to own execution. Map your internal champions — and cultivate them." },
    { title: "Align incentives.", body: "Tie sustainability to decision-making power. If ESG shows up in reporting but not in performance reviews, capital approvals, or executive compensation, it's not yet integrated. Integration starts with what gets rewarded." },
    { title: "Anchor sustainability in capital allocation.", body: "Nothing says strategic priority like funding. ESG priorities must inform where capital is deployed, which projects get greenlit, and how trade-offs are resolved at the portfolio level." },
    { title: "Make your trade-offs explicit.", body: "Be honest about what you can do and what you cannot. Acknowledge when progress comes at a cost. This builds internal credibility and avoids future accusations of overreach or greenwashing." },
    { title: "Pay attention to who is folding — and who is still holding the line.", body: "This moment is revealing. Watch carefully. Which companies are quietly backing away, and which are staying the course without fanfare? Who's rebranding without substance — and who's quietly doubling down? These patterns will shape the next phase of the field." },
    { title: "Stay grounded in the business.", body: "Sustainability should inform core strategy, not orbit it. Whether you're in healthcare, finance, manufacturing or tech — connect ESG to your value proposition, operating model, and sector-specific risks." },
    { title: "Say less, mean more.", body: "In a volatile environment, credibility matters more than visibility. Don't announce what you haven't built. Let action lead language — and let the results speak when the noise subsides." }
];

const dontItems = [
    { title: "Don't confuse communication with commitment.", body: "Sustainability isn't a narrative — it's a set of decisions. Announcing intentions is easy. Following through under pressure is not. If your ESG efforts are more visible than they are embedded, they will collapse under scrutiny." },
    { title: "Don't outsource conviction.", body: "If ESG lives only in a specialist team or a slide deck, it won't survive contact with the core business. Ownership must be distributed, especially at the top. Delegated belief is belief deferred." },
    { title: "Don't bolt ESG onto a legacy model.", body: "You can't retrofit integrity. If your value creation depends on externalising harm, no amount of ESG overlay will make the strategy sustainable. Fix the engine — not just the dashboard." },
    { title: "Don't let disclosure replace decision-making.", body: "Publishing a report is not the same as shifting priorities. Metrics may satisfy compliance, but they don't automatically drive change. If reporting becomes a ritual rather than a reckoning, the organisation learns to perform rather than transform." },
    { title: "Don't bury trade-offs.", body: "Progress isn't always win-win. Real ESG strategy requires choosing what to protect — and what to leave behind. If you're constantly smoothing tension, you're avoiding strategy." },
    { title: "Don't reduce ESG to risk avoidance.", body: "Caution has its place, but if your main concern is litigation or backlash, you're not leading — you're insulating. ESG should expand your vision, not shrink it to reputational calculus." },
    { title: "Don't reposition to escape pressure.", body: "Swapping 'ESG' for 'resilience' or 'responsible business' might ease stakeholder tension, but if the underlying commitments stay the same — or quietly weaken — it's not adaptation, it's retreat. The political climate may be volatile, but strategy requires holding shape under pressure, not bending to sentiment." },
    { title: "Don't mistake internal consensus for alignment.", body: "Agreement is easy when everything stays abstract. But when decisions get hard — when costs emerge, when pace matters — does the agreement hold? If not, you don't have alignment. You have avoidance." },
    { title: "Don't over-own the work.", body: "If the ESG agenda depends entirely on your presence to persist, it's more fragile than you think. Build continuity. Distribute accountability. This isn't about legacy — it's about resilience." },
    { title: "Don't confuse retreat with adaptation.", body: "Pulling back may feel prudent, but retreat often leaves you unprepared for what's next. ESG is not going away — it's evolving. If you abandon the work now, you may find yourself rebuilding it later, under worse conditions." }
];

const questions = [
    { q: "Who really holds the power to approve, delay, or veto sustainability decisions — and why?", body: "You may carry the responsibility for targets, disclosures, and initiatives — but do you have the authority to shape outcomes? Trace the actual decision-making pathways. If those decision-makers lie outside your reach, then your task isn't just execution — it's organisational change." },
    { q: "When ESG goals collide with short-term business pressures, how are trade-offs surfaced — and who decides how to resolve them?", body: "Every organisation faces moments when long-term commitments meet short-term demands. The real question is whether those tensions are surfaced transparently and resolved deliberately — or quietly buried." },
    { q: "How directly does sustainability shape your company's core strategic choices?", body: "Does ESG influence which products are developed, which markets are entered, which technologies are funded — or is it confined to operational fine-tuning and external reporting? If your organisation's strategy looks the same with or without ESG, then ESG is peripheral, not strategic." },
    { q: "What would your operating model look like if ESG were genuinely internalised?", body: "Would core processes change? Would incentives shift? Would procurement, hiring, or supplier relationships look different? The gap between your current model and this imagined version reveals where work remains." },
    { q: "At what point in your capital allocation process does ESG come in — and what weight does it carry?", body: "Do ESG criteria shape which projects are prioritised? Or are they simply reviewed after the financial case is already closed? You can't integrate what doesn't influence resource flow." },
    { q: "If your company went silent on ESG for a year, what would still be true?", body: "Imagine a year with no sustainability updates, no press releases, no keynote appearances. What would continue to operate differently because of ESG? True integration leaves behind operational evidence." },
    { q: "What part of your ESG agenda would you still stand by if the external pressure completely disappeared?", body: "Strip away ratings, rankings, stakeholder scrutiny, and media visibility. What would your organisation still choose to uphold? That's your strategic core. Everything else is conditional." }
];

const personalQs = [
    { q: "What have I learned to live with that I once said I wouldn't?", body: "The longer you stay inside a system that resists change, the more you adapt to its rhythms — sometimes without noticing. Small concessions add up. It's worth asking: what behaviours or compromises have you come to accept that once felt unacceptable?" },
    { q: "What conversations am I avoiding, and what story do I tell myself about why?", body: "Silence can be strategic, even wise. But over time, it becomes habit. Certain truths get pushed down. Knowing why you've gone quiet is the first step toward deciding if it's time to speak." },
    { q: "When I speak about ESG, am I saying what I believe — or what I think they can hear?", body: "Language is tactical, especially in contested terrain. But over time, translation can become distortion. If your words no longer reflect your convictions, you're not just adapting to power — you're adjusting your truth." },
    { q: "What part of the ESG agenda depends entirely on me to stay alive?", body: "If the work you've led would vanish the moment you walk away, it's more fragile than it appears. What would it take to make your efforts outlast your involvement?" },
    { q: "Who do I trust inside this system — and who do I perform for?", body: "Not every ally shares your purpose. Some offer genuine support. Others offer access or comfort — at the price of caution. Who are the people who help you act more clearly, more boldly?" },
    { q: "What am I still willing to lose for this work?", body: "There's a cost to leading from within. Your threshold changes over time — especially in moments of exhaustion. Revisiting this question helps you stay honest about your limits and remember what made the risk feel worth taking." },
    { q: "Am I proud of the version of myself this work is shaping?", body: "You are always becoming someone — through what you tolerate, challenge, defend, or stay silent about. In this moment, in this climate, in this organisation — are you becoming someone you'd respect?" }
];

// ── State ──
const scores = {};       // key -> number 1-7
const reflections = {};  // key -> string

// ── Scale HTML helper ──
function scaleHTML(key) {
    let html = '<div class="scale-row">';
    html += '<div class="scale-label-row"><span>1 — We don\'t do this</span><span>7 — We do this well</span></div>';
    html += '<div class="scale-buttons">';
    for (let n = 1; n <= 7; n++) {
        html += `<button class="scale-btn" onclick="setScore('${key}', ${n}, this)">${n}</button>`;
    }
    html += '</div></div>';
    return html;
}

// ── Render Cards (Do / Don't) ──
function renderCards(items, containerId, prefix) {
    const container = document.getElementById(containerId);
    items.forEach((item, i) => {
        const key = prefix + '-' + i;
        const card = document.createElement('div');
        card.className = 'playbook-card';
        card.innerHTML = `
            <div class="card-header" onclick="toggleCard(this)">
                <div class="card-header-left">
                    <span class="card-number">${i + 1}.</span>
                    <span class="card-title">${item.title}</span>
                </div>
                <svg class="card-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="card-body">
                <div class="card-body-inner">
                    <p>${item.body}</p>
                    ${scaleHTML(key)}
                </div>
            </div>
        `;
        container.appendChild(card);
    });
}

// ── Render Questions with textarea only ──
function renderQuestions(items, containerId, prefix, cardClass) {
    const container = document.getElementById(containerId);
    items.forEach((item, i) => {
        const key = prefix + '-' + i;
        const card = document.createElement('div');
        card.className = cardClass;
        card.innerHTML = `
            <h3>${i + 1}. ${item.q}</h3>
            <p>${item.body}</p>
            <textarea class="reflection-textarea" placeholder="Your thoughts..." oninput="saveReflection('${key}', this.value)"></textarea>
        `;
        container.appendChild(card);
    });
}

// ── Interactions ──
function toggleCard(header) {
    header.closest('.playbook-card').classList.toggle('open');
}

function setScore(key, value, btn) {
    scores[key] = value;
    const row = btn.parentElement;
    row.querySelectorAll('.scale-btn').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    updateSummary();
}

function saveReflection(key, value) {
    reflections[key] = value;
}

function updateSummary() {
    const vals = Object.values(scores);
    const count = vals.length;
    const avg = count > 0 ? (vals.reduce((a, b) => a + b, 0) / count) : 0;

    document.getElementById('avg-score').textContent = count > 0 ? avg.toFixed(1) : '—';
    document.getElementById('count-rated').textContent = count;
    document.getElementById('summary-bar').style.width = count > 0 ? ((avg / 7) * 100) + '%' : '0%';

    // Heatmap
    const heatmapColors = ['', '#c53030', '#d97706', '#ca8a04', '#65a30d', '#16a34a', '#059669', '#0d9488'];
    const heatmapPanel = document.getElementById('heatmap-panel');
    const doRow = document.getElementById('heatmap-do');
    const dontRow = document.getElementById('heatmap-dont');
    doRow.innerHTML = '';
    dontRow.innerHTML = '';

    for (let i = 0; i < 10; i++) {
        const sdo = scores['do-' + i];
        const sdont = scores['dont-' + i];
        doRow.appendChild(makeCell(i, sdo, doItems[i].title, heatmapColors));
        dontRow.appendChild(makeCell(i, sdont, dontItems[i].title, heatmapColors));
    }
    if (count > 0) heatmapPanel.classList.add('visible');
    else heatmapPanel.classList.remove('visible');

    // Insights: top 3 and bottom 3
    const insightsPanel = document.getElementById('insights-panel');
    if (count >= 3) {
        const allScored = [];
        doItems.forEach((item, i) => { if (scores['do-' + i]) allScored.push({ title: item.title, score: scores['do-' + i] }); });
        dontItems.forEach((item, i) => { if (scores['dont-' + i]) allScored.push({ title: item.title, score: scores['dont-' + i] }); });
        allScored.sort((a, b) => b.score - a.score);

        const top3 = allScored.slice(0, 3);
        const bottom3 = allScored.slice(-3).reverse();

        document.getElementById('insights-strengths').innerHTML = top3.map(it =>
            `<div class="insight-item strength"><span class="insight-score">${it.score}</span><span>${truncate(it.title, 70)}</span></div>`
        ).join('');
        document.getElementById('insights-priorities').innerHTML = bottom3.map(it =>
            `<div class="insight-item priority"><span class="insight-score">${it.score}</span><span>${truncate(it.title, 70)}</span></div>`
        ).join('');
        insightsPanel.classList.add('visible');
    } else {
        insightsPanel.classList.remove('visible');
    }
}

function makeCell(i, score, title, colors) {
    const cell = document.createElement('div');
    cell.className = 'heatmap-cell' + (score ? '' : ' heatmap-unrated');
    if (score) cell.style.background = colors[score];
    cell.innerHTML = `<span class="cell-number">${score || '–'}</span><span class="cell-tooltip">${(i+1)}. ${title}</span>`;
    return cell;
}

function truncate(str, max) {
    if (str.length <= max) return str;
    return str.substring(0, max).replace(/\s+\S*$/, '') + '…';
}

// ── Progress Bar ──
function updateProgress() {
    const sections = document.querySelectorAll('.playbook-section');
    const steps = document.querySelectorAll('.progress-step');
    const scrollPos = window.scrollY + window.innerHeight * 0.4;

    let activeIndex = 0;
    sections.forEach((section, i) => {
        if (scrollPos >= section.offsetTop) activeIndex = i;
    });

    steps.forEach((step, i) => {
        step.classList.remove('active', 'completed');
        if (i < activeIndex) step.classList.add('completed');
        else if (i === activeIndex) step.classList.add('active');
    });
}

document.querySelectorAll('.progress-step').forEach(step => {
    step.addEventListener('click', () => {
        const idx = step.dataset.section;
        const target = document.getElementById('section-' + idx);
        if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
});

window.addEventListener('scroll', updateProgress);

// ── Export ──
function exportReflections() {
    const vals = Object.values(scores);
    const count = vals.length;
    const avg = count > 0 ? (vals.reduce((a, b) => a + b, 0) / count).toFixed(1) : '\u2014';

    // Heatmap colours
    const hColors = ['', '#c53030', '#d97706', '#ca8a04', '#65a30d', '#16a34a', '#059669', '#0d9488'];

    // Build heatmap HTML for export
    let heatmapHTML = '';
    if (count > 0) {
        heatmapHTML += '<div class="heatmap"><h3>Assessment at a Glance</h3>';
        heatmapHTML += '<div class="hm-label">10 Things to Do</div><div class="hm-row">';
        for (let i = 0; i < 10; i++) {
            const s = scores['do-' + i];
            const bg = s ? hColors[s] : '#e2e8f0';
            const cl = s ? '#fff' : '#a0aec0';
            heatmapHTML += `<div class="hm-cell" style="background:${bg};color:${cl};">${s || '\u2013'}</div>`;
        }
        heatmapHTML += '</div><div class="hm-label">10 Things to Avoid</div><div class="hm-row">';
        for (let i = 0; i < 10; i++) {
            const s = scores['dont-' + i];
            const bg = s ? hColors[s] : '#e2e8f0';
            const cl = s ? '#fff' : '#a0aec0';
            heatmapHTML += `<div class="hm-cell" style="background:${bg};color:${cl};">${s || '\u2013'}</div>`;
        }
        heatmapHTML += '</div>';
        heatmapHTML += '<div class="hm-legend"><span>Low (1)</span><span style="display:flex;gap:3px;">';
        hColors.slice(1).forEach(c => { heatmapHTML += `<span style="display:inline-block;width:14px;height:14px;border-radius:2px;background:${c};"></span>`; });
        heatmapHTML += '</span><span>High (7)</span></div></div>';
    }

    // Build insights HTML for export
    let insightsHTML = '';
    if (count >= 3) {
        const allScored = [];
        doItems.forEach((item, i) => { if (scores['do-' + i]) allScored.push({ title: item.title, score: scores['do-' + i] }); });
        dontItems.forEach((item, i) => { if (scores['dont-' + i]) allScored.push({ title: item.title, score: scores['dont-' + i] }); });
        allScored.sort((a, b) => b.score - a.score);
        const top3 = allScored.slice(0, 3);
        const bottom3 = allScored.slice(-3).reverse();

        insightsHTML += '<div class="insights"><div class="ins-col"><h4 class="ins-strong">Strongest Areas</h4>';
        top3.forEach(it => { insightsHTML += `<div class="ins-item"><span class="ins-score ins-green">${it.score}</span> ${esc(it.title)}</div>`; });
        insightsHTML += '</div><div class="ins-col"><h4 class="ins-priority">Priority Areas</h4>';
        bottom3.forEach(it => { insightsHTML += `<div class="ins-item"><span class="ins-score ins-amber">${it.score}</span> ${esc(it.title)}</div>`; });
        insightsHTML += '</div></div>';
    }

    let html = `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>My Playbook Reflections</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
@page{margin:0;size:A4}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Source Sans 3',Helvetica,Arial,sans-serif;max-width:100%;margin:0 auto;padding:0;color:#1a202c;line-height:1.65;font-size:10.5pt}
.pdf-header{background:#1a202c;color:#fff;padding:40px 48px 32px;margin:0 0 28px;width:100%}
.pdf-header h1{font-family:'Cormorant Garamond',Georgia,serif;font-size:26pt;font-weight:500;margin-bottom:4px;color:#fff}
.pdf-header .sub{font-size:11pt;color:rgba(255,255,255,0.65);font-weight:300}
.pdf-header .date{font-size:8.5pt;color:rgba(255,255,255,0.4);margin-top:8px}
.pdf-body{padding:0 48px}
.summary-row{display:flex;gap:24px;margin:20px 0 24px;padding:18px 24px;background:#f7fafc;border-radius:6px;border:1px solid #e2e8f0}
.summary-row .stat{flex:1;text-align:center}
.summary-row .stat-num{font-family:'Cormorant Garamond',Georgia,serif;font-size:28pt;font-weight:700;color:#1a365d}
.summary-row .stat-label{font-size:8.5pt;color:#718096;margin-top:2px}
h2{font-family:'Cormorant Garamond',Georgia,serif;color:#1a365d;font-size:16pt;margin-top:28px;padding-top:20px;border-top:2px solid #e2e8f0;margin-bottom:14px;page-break-after:avoid}
h2:first-of-type{border-top:none;margin-top:0;padding-top:0}
h3{font-family:'Source Sans 3',sans-serif;color:#2c5282;font-size:10.5pt;font-weight:600;margin-top:14px;margin-bottom:3px;page-break-after:avoid}
.score{display:inline-block;padding:1px 8px;border-radius:3px;font-size:8pt;font-weight:600;margin-left:6px;vertical-align:middle}
.score-high{background:#f0fdf4;color:#166534;border:1px solid #86efac}
.score-mid{background:#fefce8;color:#854d0e;border:1px solid #fde047}
.score-low{background:#fef2f2;color:#991b1b;border:1px solid #fca5a5}
.reflection{background:#fffaf5;padding:10px 14px;border-left:3px solid #c53030;margin:6px 0 12px;font-size:10pt;line-height:1.6;white-space:pre-wrap;page-break-inside:auto}
.heatmap{margin:20px 0 24px;page-break-inside:avoid}
.heatmap h3{font-family:'Cormorant Garamond',Georgia,serif;color:#1a365d;font-size:13pt;font-weight:500;margin-bottom:12px;border:none;padding:0}
.hm-label{font-size:8pt;font-weight:600;text-transform:uppercase;letter-spacing:0.1em;color:#718096;margin-bottom:6px;margin-top:12px}
.hm-row{display:flex;gap:5px}
.hm-cell{width:36px;height:36px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:10pt;font-weight:700;flex-shrink:0}
.hm-legend{display:flex;align-items:center;justify-content:flex-start;gap:8px;margin-top:10px;font-size:7.5pt;color:#718096}
.insights{display:flex;gap:24px;margin:16px 0 24px;page-break-inside:avoid}
.ins-col{flex:1}
.ins-col h4{font-size:8.5pt;font-weight:600;text-transform:uppercase;letter-spacing:0.08em;padding-bottom:6px;border-bottom:1px solid #e2e8f0;margin-bottom:8px}
.ins-strong{color:#16a34a}
.ins-priority{color:#d97706}
.ins-item{font-size:9.5pt;margin-bottom:5px;line-height:1.4;color:#1a202c}
.ins-score{display:inline-block;font-family:'Cormorant Garamond',Georgia,serif;font-weight:700;font-size:11pt;min-width:18px;text-align:right;margin-right:6px}
.ins-green{color:#16a34a}
.ins-amber{color:#d97706}
.pdf-footer{margin-top:32px;padding-top:14px;border-top:1px solid #e2e8f0;color:#718096;font-size:8pt;text-align:center}
.pdf-footer a{color:#2c5282;text-decoration:none}
@media print{
  .pdf-header,.hm-cell,.score,.score-high,.score-mid,.score-low,.ins-green,.ins-amber,.ins-strong,.ins-priority,.summary-row{-webkit-print-color-adjust:exact;print-color-adjust:exact}
}
</style></head><body>`;

    // Header
    html += '<div class="pdf-header">';
    html += '<h1>Holding the Line</h1>';
    html += '<div class="sub">My Playbook Reflections</div>';
    html += `<div class="date">Generated ${new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' })}</div>`;
    html += '</div>';

    // Wrap remaining content in pdf-body for padding
    html += '<div class="pdf-body">';

    // Summary stats
    if (count > 0) {
        html += `<div class="summary-row"><div class="stat"><div class="stat-num">${avg}</div><div class="stat-label">Average score (out of 7)</div></div><div class="stat"><div class="stat-num">${count}</div><div class="stat-label">Items rated (out of 20)</div></div></div>`;
    }

    // Heatmap + Insights
    html += heatmapHTML;
    html += insightsHTML;

    // Do items
    html += '<h2>10 Things To Do Now</h2>';
    doItems.forEach((item, i) => {
        const s = scores['do-' + i];
        const badge = s ? ` <span class="score ${scoreCls(s)}">${s} / 7</span>` : '';
        html += `<h3>${i+1}. ${esc(item.title)}${badge}</h3>`;
    });

    // Don't items
    html += '<h2>10 Things To Avoid</h2>';
    dontItems.forEach((item, i) => {
        const s = scores['dont-' + i];
        const badge = s ? ` <span class="score ${scoreCls(s)}">${s} / 7</span>` : '';
        html += `<h3>${i+1}. ${esc(item.title)}${badge}</h3>`;
    });

    // Organisational questions
    html += '<h2>7 Questions To Ask</h2>';
    questions.forEach((item, i) => {
        const r = reflections['q-' + i];
        html += `<h3>${i+1}. ${esc(item.q)}</h3>`;
        if (r && r.trim()) {
            html += `<div class="reflection">${esc(r)}</div>`;
        }
    });

    // Personal questions
    html += '<h2>7 Things Only I Can Answer</h2>';
    personalQs.forEach((item, i) => {
        const r = reflections['p-' + i];
        html += `<h3>${i+1}. ${esc(item.q)}</h3>`;
        if (r && r.trim()) {
            html += `<div class="reflection">${esc(r)}</div>`;
        }
    });

    html += '<div class="pdf-footer"><p>From &ldquo;Holding the Line: A Playbook for ESG Leadership in Hostile Terrain&rdquo;</p><p>&copy; 2026 Professor Ioannis Ioannou. All rights reserved. &middot; <a href="https://www.ioannou.us">ioannou.us</a></p></div>';
    html += '</div>'; // close pdf-body
    html += '</body></html>';

    // Open in new window for print-to-PDF
    const win = window.open('', '_blank');
    win.document.write(html);
    win.document.close();
    win.onload = function() {
        setTimeout(function() { win.print(); }, 400);
    };
}

function scoreCls(s) {
    if (s >= 5) return 'score-high';
    if (s >= 3) return 'score-mid';
    return 'score-low';
}

function esc(str) {
    return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}

// ── Initialise ──
renderCards(doItems, 'do-cards', 'do');
renderCards(dontItems, 'dont-cards', 'dont');
renderQuestions(questions, 'questions-container', 'q', 'question-card');
renderQuestions(personalQs, 'personal-container', 'p', 'personal-card');
updateProgress();
</script>

</body>
</html>
